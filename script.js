var votingData={'WA': {'tippingPower': '0.7%', 'votingPowerIndex': '0.3', 'fillKey': '0.7%'}, 'DE': {'tippingPower': '0.8%', 'votingPowerIndex': '2.5', 'fillKey': '0.8%'}, 'WI': {'tippingPower': '6.4%', 'votingPowerIndex': '2.8', 'fillKey': '6.4%'}, 'WV': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'HI': {'tippingPower': '0.1%', 'votingPowerIndex': '0.3', 'fillKey': '0.1%'}, 'FL': {'tippingPower': '18.1%', 'votingPowerIndex': '2.6', 'fillKey': '18.1%'}, 'WY': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'NH': {'tippingPower': '2.5%', 'votingPowerIndex': '4.6', 'fillKey': '2.5%'}, 'NJ': {'tippingPower': '2.5%', 'votingPowerIndex': '0.9', 'fillKey': '2.5%'}, 'NM': {'tippingPower': '1.3%', 'votingPowerIndex': '2.2', 'fillKey': '1.3%'}, 'TX': {'tippingPower': '0.6%', 'votingPowerIndex': '0.1', 'fillKey': '0.6%'}, 'LA': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'NC': {'tippingPower': '9.1%', 'votingPowerIndex': '2.6', 'fillKey': '9.1%'}, 'ND': {'tippingPower': '0.2%', 'votingPowerIndex': '0.7', 'fillKey': '0.2%'}, 'NE': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'TN': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'NY': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'PA': {'tippingPower': '10.6%', 'votingPowerIndex': '2.5', 'fillKey': '10.6%'}, 'RI': {'tippingPower': '0.9%', 'votingPowerIndex': '2.8', 'fillKey': '0.9%'}, 'NV': {'tippingPower': '3.6%', 'votingPowerIndex': '4.4', 'fillKey': '3.6%'}, 'VA': {'tippingPower': '6.1%', 'votingPowerIndex': '2.1', 'fillKey': '6.1%'}, 'CO': {'tippingPower': '5.5%', 'votingPowerIndex': '2.6', 'fillKey': '5.5%'}, 'AK': {'tippingPower': '0.3%', 'votingPowerIndex': '1.3', 'fillKey': '0.3%'}, 'AL': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'AR': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'VT': {'tippingPower': '0.1%', 'votingPowerIndex': '0.4', 'fillKey': '0.1%'}, 'IL': {'tippingPower': '0.4%', 'votingPowerIndex': '0.1', 'fillKey': '0.4%'}, 'GA': {'tippingPower': '2.4%', 'votingPowerIndex': '0.8', 'fillKey': '2.4%'}, 'IN': {'tippingPower': '0.2%', 'votingPowerIndex': '0.1', 'fillKey': '0.2%'}, 'IA': {'tippingPower': '2.3%', 'votingPowerIndex': '1.9', 'fillKey': '2.3%'}, 'OK': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'AZ': {'tippingPower': '1.8%', 'votingPowerIndex': '1.0', 'fillKey': '1.8%'}, 'CA': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'ID': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'CT': {'tippingPower': '0.4%', 'votingPowerIndex': '0.3', 'fillKey': '0.4%'}, 'ME': {'tippingPower': '0.1%', 'votingPowerIndex': '0.3', 'fillKey': '0.1%'}, 'MD': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'MA': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'OH': {'tippingPower': '8.5%', 'votingPowerIndex': '2.0', 'fillKey': '8.5%'}, 'UT': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'MO': {'tippingPower': '0.2%', 'votingPowerIndex': '0.1', 'fillKey': '0.2%'}, 'MN': {'tippingPower': '2.9%', 'votingPowerIndex': '1.3', 'fillKey': '2.9%'}, 'MI': {'tippingPower': '8.7%', 'votingPowerIndex': '2.4', 'fillKey': '8.7%'}, 'KS': {'tippingPower': '0.3%', 'votingPowerIndex': '0.3', 'fillKey': '0.3%'}, 'MT': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'MS': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'SC': {'tippingPower': '0.3%', 'votingPowerIndex': '0.2', 'fillKey': '0.3%'}, 'KY': {'tippingPower': '0.1%', 'votingPowerIndex': '0.1', 'fillKey': '0.1%'}, 'OR': {'tippingPower': '0.3%', 'votingPowerIndex': '0.2', 'fillKey': '0.3%'}, 'SD': {'tippingPower': '0.1%', 'votingPowerIndex': '0.2', 'fillKey': '0.1%'}};
var colorKey={'0.6%': '#ffffff', '10.6%': '#8c19ff', '0.4%': '#ffffff', '8.7%': '#a64cff', '6.4%': '#bf7fff', '8.5%': '#a64cff', '9.1%': '#9932ff', '0.8%': '#ffffff', '1.3%': '#ffffff', '2.3%': '#f2e5ff', '2.5%': '#f2e5ff', '0.2%': '#ffffff', '0.1%': '#ffffff', '0.7%': '#ffffff', '1.8%': '#ffffff', '2.9%': '#f2e5ff', '5.5%': '#cc99ff', '18.1%': '#8000ff', '3.6%': '#e5ccff', '6.1%': '#bf7fff', '0.9%': '#ffffff', '2.4%': '#f2e5ff', '0.3%': '#ffffff'};

function scrapeSite(){
    var url = "http://projects.fivethirtyeight.com/2016-election-forecast/"
    $.get(url, function(data) {
        parseHTMLdata(data);
    });
}

//scrapeSite();

function parseHTMLdata(htmlData) {
    console.log($.parseHTML(htmlData));
}

function mapDOM(element, json) {
    var treeObject = {};

    // If string convert to document Node
    if (typeof element === "string") {
        if (window.DOMParser) {
            parser = new DOMParser();
            docNode = parser.parseFromString(element, "text/xml");
        } else { // Microsoft strikes again
            docNode = new ActiveXObject("Microsoft.XMLDOM");
            docNode.async = false;
            docNode.loadXML(element);
        }
        element = docNode.firstChild;
    }

    //Recursively loop through DOM elements and assign properties to object
    function treeHTML(element, object) {
        object["type"] = element.nodeName;
        var nodeList = element.childNodes;
        if (nodeList != null) {
            if (nodeList.length) {
                object["content"] = [];
                for (var i = 0; i < nodeList.length; i++) {
                    if (nodeList[i].nodeType == 3) {
                        object["content"].push(nodeList[i].nodeValue);
                    } else {
                        object["content"].push({});
                        treeHTML(nodeList[i], object["content"][object["content"].length - 1]);
                    }
                }
            }
        }
        if (element.attributes != null) {
            if (element.attributes.length) {
                object["attributes"] = {};
                for (var i = 0; i < element.attributes.length; i++) {
                    object["attributes"][element.attributes[i].nodeName] = element.attributes[i].nodeValue;
                }
            }
        }
    }
    treeHTML(element, treeObject);

    return (json) ? JSON.stringify(treeObject) : treeObject;
}


function generateHexGradient(numColors) {
    var rainbow = new Rainbow();
    rainbow.setNumberRange(1, numColors);
    rainbow.setSpectrum('red', 'black');
    var s='';
    for (var i = 1; i <= numColors; i++) {
        var hexColour = rainbow.colourAt(i);
        s += '#' + hexColour + ',';
    }
    var arr = s.split(",")
    return arr
}

console.log(generateHexGradient(50));

function sortData(data){

}

var election = new Datamap({
    scope: 'usa',
    element: document.getElementById('map_election'),
    geographyConfig: {
        highlightBorderColor: '#bada55',
        popupTemplate: function(geography, data) {
            return '<div class="hoverinfo">' + geography.properties.name +
                '<br> Tipping Power: ' + data.tippingPower +
                '<br> Voting Power Index: ' + data.votingPowerIndex
        },
        highlightBorderWidth: 3
    },

    fills: colorKey,
    data: votingData
});
election.labels();
